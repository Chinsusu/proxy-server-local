# PGW Network Optimizations
# Thêm vào /etc/sysctl.conf hoặc /etc/sysctl.d/99-pgw.conf

# Tăng số lượng kết nối đồng thời
net.core.somaxconn = 8192
net.ipv4.tcp_max_syn_backlog = 8192
net.core.netdev_max_backlog = 8192

# Tối ưu TCP timeouts
net.ipv4.tcp_fin_timeout = 15
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_keepalive_time = 300
net.ipv4.tcp_keepalive_intvl = 30
net.ipv4.tcp_keepalive_probes = 3

# Tăng connection tracking table
net.netfilter.nf_conntrack_max = 131072

# Tối ưu buffer sizes
net.core.rmem_max = 67108864
net.core.wmem_max = 67108864
net.ipv4.tcp_rmem = 4096 87380 67108864
net.ipv4.tcp_wmem = 4096 65536 67108864

# Giảm swap usage
vm.swappiness = 10

# Tối ưu file system
fs.file-max = 2097152
